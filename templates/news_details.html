{% extends "base.html" %}
{% block title %}{{ news.title }}{% endblock %}

{% block content %}

<div class="container my-4">
<div class="row g-4">

    <div class="col-lg-8">
        <div class="p-4 shadow-lg rounded bg-white position-relative" style="border-top:5px solid #bb1919;">

            {% if current_user.is_authenticated and current_user.is_admin %}
            <a href="{{ url_for('delete_news', news_id=news.id) }}"
               class="btn btn-danger btn-sm position-absolute top-0 end-0 m-2"
               onclick="return confirm('Are you sure you want to delete this?');">
                Delete
            </a>
            {% endif %}

            <h1 style="font-weight:700;color:#bb1919;">{{ news.title }}</h1>

            <p class="text-muted mb-2">
                <strong>Category:</strong> {{ news.category }}
            </p>

            {% if news.image %}
                <img src="{{ url_for('static', filename='uploads/' ~ news.image) }}"
                     class="img-fluid rounded mb-4"
                     style="max-height:420px;object-fit:cover;">
            {% endif %}

            <p style="font-size:1.05rem;line-height:1.7;">
                {{ news.content }}
            </p>
        </div>
    </div>

    <div class="col-lg-4">

        <div class="p-4 shadow-lg rounded bg-white mb-3"
             style="border-top:5px solid #bb1919;">

            <h4 class="mb-2 bg-white border-bottom pb-2"
                style="font-weight:700;color:#bb1919;">
                Comments ({{ news.comments|length }})
            </h4>

            <div style="max-height:320px; overflow-y:auto; padding-right:6px;">

                {% if news.comments %}
                    <ul class="list-group list-group-flush">
                    {% for comment in news.comments %}
                        <li class="list-group-item">
                            {{ comment.text }} <br>
                            <small class="text-muted">{{ comment.commentUser().username }}</small>
                        </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted text-center mt-3">
                        No comments yet. Be the first to comment ðŸ™‚
                    </p>
                {% endif %}

            </div>
        </div>

        {% if current_user.is_authenticated %}
        <div class="p-4 shadow-lg rounded bg-white" style="border-top:5px solid #bb1919;">
            <h5 class="mb-3" style="font-weight:700;color:#bb1919;">Add Comment</h5>
            <form method="POST">
                {{ form.hidden_tag() }}
                {{ form.text(class="form-control mb-3", placeholder="Write your comment...") }}
                {{ form.submit(class="btn btn-bbc w-100 rounded-pill") }}
            </form>
        </div>
        {% else %}
            <div class="alert alert-info text-center">
                <a href="{{ url_for('login') }}">Login</a> to add a comment.
            </div>
        {% endif %}

        <a href="{{ url_for('index') }}" class="btn btn-secondary w-100 mt-3 rounded-pill">
            Back to All News
        </a>

    </div>

</div>
</div>

{% endblock %}

